extends layout

block content
  if (userpermissions.filesystem_view)
    .overflow-hidden.bg-white.shadow.mt-5.rounded-lg
      nav.flex.border-b.border-gray-200.bg-white(aria-label='Breadcrumb').overflow-x-auto.mr-4.rounded-lg
        ol.mx-auto.flex.w-full.max-w-screen-xl.space-x-4.px-4(role='list', class='sm:px-6 lg:px-8')
          li.flex
            .flex.items-center
              a.text-gray-400(href='?path=/', class='hover:text-gray-500')
                // Heroicon name: mini/home
                svg.h-full.w-5.flex-shrink-0(xmlns='http://www.w3.org/2000/svg', viewBox='0 0 20 20', fill='currentColor', aria-hidden='true')
                  path(fill-rule='evenodd', d='M9.293 2.293a1 1 0 011.414 0l7 7A1 1 0 0117 11h-1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-3a1 1 0 00-1-1H9a1 1 0 00-1 1v3a1 1 0 01-1 1H5a1 1 0 01-1-1v-6H3a1 1 0 01-.707-1.707l7-7z', clip-rule='evenodd')
                span.sr-only Home
          li.flex.opacity-0.pointer-events-none
            .flex.items-center
              svg.h-full.w-6.flex-shrink-0.text-gray-200(viewBox='0 0 24 44', preserveAspectRatio='none', fill='currentColor', xmlns='http://www.w3.org/2000/svg', aria-hidden='true')
                path(d='M.293 0l22 22-22 22h1.414l22-22-22-22H.293z')
          each folder in data.path.toString().split("/").filter(f => f !== "")
            li.flex
              .flex.items-center
                svg.h-full.w-6.flex-shrink-0.text-gray-200(viewBox='0 0 24 44', preserveAspectRatio='none', fill='currentColor', xmlns='http://www.w3.org/2000/svg', aria-hidden='true')
                  path(d='M.293 0l22 22-22 22h1.414l22-22-22-22H.293z')
                a.ml-4.text-sm.font-medium.text-gray-500(href="?path=" + data.path.split(folder)[0]+folder, class='hover:text-gray-700')=folder

    .overflow-hidden.bg-white.shadow.mt-5.rounded-lg.min-h-full.h-full.max-h-60.overflow-y-auto
      ul.divide-y.divide-gray-200(role='list').overflow-y-auto
        if data.status < 300 && !data.isFile
          li
            a.block(href='?path=' + data.bpath, class='hover:bg-gray-50')
              .grid.grid-cols-3
                .flex.text-sm.m-4(class="md:m-2")
                  p.truncate.font-medium.text-emerald-600 ..
          each object in data.data
            li
              a.block(href='?path='+(object.type === "symlink" ? object.aspath : object.afpath), class='hover:bg-gray-50')
                .grid.grid-cols-3
                  .flex.text-sm.m-4(class="md:m-2")
                    p.truncate.font-medium(class=(object.type === "directory" ? "text-emerald-600" : (object.type == "symlink" ? "text-red-300" : "text-black")))=object.name
                  .flex.text-sm.m-4(class="md:m-2")
                    p.ml-1.flex-shrink-0.font-normal.text-gray-500=(object.type !== "symlink" ? object.permissions : object.aspath)
                  if object.type !== "file"
                    svg.h-5.w-5.text-gray-400.justify-self-end.m-4(xmlns='http://www.w3.org/2000/svg', viewBox='0 0 20 20', fill='currentColor', aria-hidden='true' class="md:m-2")
                      path(fill-rule='evenodd', d='M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z', clip-rule='evenodd')
                .flex.items-center.px-4.py-2(class='sm:px-6').hidden
                  .min-w-0.flex-1(class='sm:flex sm:items-center sm:justify-between')
                    .truncate
                      .flex.text-sm
                        p.truncate.font-medium(class=(object.type === "directory" ? "text-emerald-600" : (object.type == "symlink" ? "text-red-300" : "text-black")))=object.name
                        p.ml-1.flex-shrink-0.font-normal.text-gray-500=(object.type !== "symlink" ? object.permissions : object.aspath)
                  .ml-5.flex-shrink-0
                    if object.type !== "file"
                      svg.h-5.w-5.text-gray-400(xmlns='http://www.w3.org/2000/svg', viewBox='0 0 20 20', fill='currentColor', aria-hidden='true')
                        path(fill-rule='evenodd', d='M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z', clip-rule='evenodd')
        else if data.status < 300 && data.isFile
          p Dokument, ich habe keine Lust mehr
        else
          -
            error_code = 500
            error_title = "An error occurred"
            error_desc = data.data
          include includes/error
  else
    include includes/error
